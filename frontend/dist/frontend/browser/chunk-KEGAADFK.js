import{D as A,E as V,G as $,I as d,J as H,K as J,M as K,O as Q,P as W,S as X,U as Z,W as ee,X as te,_ as re,aa as ne,ba as ie,ca as oe,d as T,da as ae,ea as le,fa as me,ga as se,ha as de,ia as ge}from"./chunk-5MBEXQZ5.js";import{Ea as m,Fa as r,Ga as t,Ha as c,Kb as S,Lb as F,Pb as I,Qa as u,Yb as L,Yc as q,Zc as R,_b as k,_c as N,ad as z,bd as B,ca as a,cd as G,db as o,dd as U,eb as f,ed as j,fb as E,fd as D,ga as p,kd as Y,la as x,qa as s}from"./chunk-55EB77JL.js";function pe(n,i){n&1&&(r(0,"mat-error"),o(1," El email es requerido "),t())}function ue(n,i){n&1&&(r(0,"mat-error"),o(1," Ingrese un email v\xE1lido "),t())}function fe(n,i){n&1&&(r(0,"mat-error"),o(1," La contrase\xF1a es requerida "),t())}function _e(n,i){n&1&&(r(0,"span"),o(1,"Iniciar Sesi\xF3n"),t())}function he(n,i){n&1&&(r(0,"span"),o(1,"Iniciando sesi\xF3n..."),t())}function be(n,i){n&1&&(r(0,"mat-error"),o(1," El email es requerido "),t())}function ve(n,i){n&1&&(r(0,"mat-error"),o(1," Ingrese un email v\xE1lido "),t())}function Ce(n,i){n&1&&(r(0,"mat-error"),o(1," El nombre es requerido "),t())}function Me(n,i){if(n&1&&(r(0,"mat-option",19),o(1),t()),n&2){let l=i.$implicit;m("value",l.value),a(),E(" ",l.label," ")}}function Pe(n,i){n&1&&(r(0,"mat-error"),o(1," Seleccione un tipo de usuario "),t())}function we(n,i){n&1&&(r(0,"mat-error"),o(1," La contrase\xF1a es requerida "),t())}function ye(n,i){n&1&&(r(0,"mat-error"),o(1," La contrase\xF1a debe tener al menos 6 caracteres "),t())}function Oe(n,i){n&1&&(r(0,"mat-error"),o(1," Confirme su contrase\xF1a "),t())}function xe(n,i){n&1&&(r(0,"mat-error"),o(1," Las contrase\xF1as no coinciden "),t())}function Ee(n,i){n&1&&(r(0,"span"),o(1,"Registrarse"),t())}function Se(n,i){n&1&&(r(0,"span"),o(1,"Registrando..."),t())}var ce=class n{constructor(i,l,e,g,_){this.fb=i;this.router=l;this.route=e;this.snackBar=g;this.authService=_;this.loginForm=this.fb.group({email:["",[d.required,d.email]],password:["",[d.required]]}),this.registerForm=this.fb.group({email:["",[d.required,d.email]],password:["",[d.required,d.minLength(6)]],confirmPassword:["",[d.required]],nombre:["",[d.required]],apellidos:[""],role:["paciente",[d.required]]},{validators:this.passwordMatchValidator}),this.returnUrl=this.route.snapshot.queryParams.returnUrl||"/"}loginForm;registerForm;isLoading=!1;hidePassword=!0;hideConfirmPassword=!0;returnUrl="/";roles=[{value:"admin",label:"Administrador"},{value:"radiologo",label:"Radi\xF3logo"},{value:"secretario",label:"Secretario"},{value:"tecnico",label:"T\xE9cnico"},{value:"paciente",label:"Paciente"}];passwordMatchValidator(i){let l=i.get("password"),e=i.get("confirmPassword");return l&&e&&l.value!==e.value?(e.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):(e?.hasError("passwordMismatch")&&e.setErrors(null),null)}onLogin(){if(this.loginForm.valid){this.isLoading=!0;let i=this.loginForm.value;this.authService.login(i).subscribe({next:l=>{this.showMessage("\xA1Inicio de sesi\xF3n exitoso!","success"),this.router.navigate([this.returnUrl]),this.isLoading=!1},error:l=>{console.error("Login error:",l),this.showMessage(l.error?.detail||"Error al iniciar sesi\xF3n","error"),this.isLoading=!1}})}}onRegister(){if(this.registerForm.valid){this.isLoading=!0;let i={email:this.registerForm.value.email,password:this.registerForm.value.password,nombre:this.registerForm.value.nombre,apellidos:this.registerForm.value.apellidos,role:this.registerForm.value.role};i.role==="paciente"?this.authService.registerPatient(i).subscribe({next:l=>{this.showMessage("\xA1Registro exitoso!","success"),this.router.navigate([this.returnUrl]),this.isLoading=!1},error:l=>{console.error("Register error:",l),this.showMessage(l.error?.detail||"Error al registrarse","error"),this.isLoading=!1}}):this.authService.register(i).subscribe({next:l=>{this.showMessage("Cuenta creada. Contacte al administrador para activaci\xF3n.","success"),this.isLoading=!1},error:l=>{console.error("Register error:",l),this.showMessage(l.error?.detail||"Error al registrarse","error"),this.isLoading=!1}})}}showMessage(i,l){this.snackBar.open(i,"Cerrar",{duration:3e3,panelClass:l==="success"?"success-snackbar":"error-snackbar"})}togglePasswordVisibility(){this.hidePassword=!this.hidePassword}toggleConfirmPasswordVisibility(){this.hideConfirmPassword=!this.hideConfirmPassword}static \u0275fac=function(l){return new(l||n)(p(X),p(k),p(L),p(A),p(q))};static \u0275cmp=x({type:n,selectors:[["app-login"]],decls:69,vars:26,consts:[[1,"login-card"],["label","Iniciar Sesi\xF3n"],[1,"login-form",3,"ngSubmit","formGroup"],["appearance","fill",1,"full-width"],["matInput","","formControlName","email","placeholder","Ingrese su email","type","email"],[4,"ngIf"],["matInput","","formControlName","password","placeholder","Ingrese su contrase\xF1a",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",1,"full-width","submit-button",3,"disabled"],["label","Registrarse"],[1,"register-form",3,"ngSubmit","formGroup"],[1,"name-row"],["appearance","fill",1,"half-width"],["matInput","","formControlName","nombre","placeholder","Nombre"],["matInput","","formControlName","apellidos","placeholder","Apellidos"],["formControlName","role"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","confirmPassword","placeholder","Confirme su contrase\xF1a",3,"type"],["mat-raised-button","","color","accent","type","submit",1,"full-width","submit-button",3,"disabled"],[3,"value"]],template:function(l,e){if(l&1&&(r(0,"mat-card",0)(1,"mat-card-title"),o(2,"Sistema de Imagenolog\xEDa"),t(),r(3,"mat-card-content")(4,"mat-tab-group")(5,"mat-tab",1)(6,"form",2),u("ngSubmit",function(){return e.onLogin()}),r(7,"mat-form-field",3)(8,"mat-label"),o(9,"Email"),t(),c(10,"input",4),s(11,pe,2,0,"mat-error",5)(12,ue,2,0,"mat-error",5),t(),r(13,"mat-form-field",3)(14,"mat-label"),o(15,"Contrase\xF1a"),t(),c(16,"input",6),r(17,"button",7),u("click",function(){return e.togglePasswordVisibility()}),r(18,"mat-icon"),o(19),t()(),s(20,fe,2,0,"mat-error",5),t(),r(21,"button",8),s(22,_e,2,0,"span",5)(23,he,2,0,"span",5),t()()(),r(24,"mat-tab",9)(25,"form",10),u("ngSubmit",function(){return e.onRegister()}),r(26,"mat-form-field",3)(27,"mat-label"),o(28,"Email"),t(),c(29,"input",4),s(30,be,2,0,"mat-error",5)(31,ve,2,0,"mat-error",5),t(),r(32,"div",11)(33,"mat-form-field",12)(34,"mat-label"),o(35,"Nombre"),t(),c(36,"input",13),s(37,Ce,2,0,"mat-error",5),t(),r(38,"mat-form-field",12)(39,"mat-label"),o(40,"Apellidos"),t(),c(41,"input",14),t()(),r(42,"mat-form-field",3)(43,"mat-label"),o(44,"Tipo de Usuario"),t(),r(45,"mat-select",15),s(46,Me,2,2,"mat-option",16),t(),s(47,Pe,2,0,"mat-error",5),t(),r(48,"mat-form-field",3)(49,"mat-label"),o(50,"Contrase\xF1a"),t(),c(51,"input",6),r(52,"button",7),u("click",function(){return e.togglePasswordVisibility()}),r(53,"mat-icon"),o(54),t()(),s(55,we,2,0,"mat-error",5)(56,ye,2,0,"mat-error",5),t(),r(57,"mat-form-field",3)(58,"mat-label"),o(59,"Confirmar Contrase\xF1a"),t(),c(60,"input",17),r(61,"button",7),u("click",function(){return e.toggleConfirmPasswordVisibility()}),r(62,"mat-icon"),o(63),t()(),s(64,Oe,2,0,"mat-error",5)(65,xe,2,0,"mat-error",5),t(),r(66,"button",18),s(67,Ee,2,0,"span",5)(68,Se,2,0,"span",5),t()()()()()()),l&2){let g,_,h,b,v,C,M,P,w,y,O;a(6),m("formGroup",e.loginForm),a(5),m("ngIf",(g=e.loginForm.get("email"))==null?null:g.hasError("required")),a(),m("ngIf",(_=e.loginForm.get("email"))==null?null:_.hasError("email")),a(4),m("type",e.hidePassword?"password":"text"),a(3),f(e.hidePassword?"visibility_off":"visibility"),a(),m("ngIf",(h=e.loginForm.get("password"))==null?null:h.hasError("required")),a(),m("disabled",e.loginForm.invalid||e.isLoading),a(),m("ngIf",!e.isLoading),a(),m("ngIf",e.isLoading),a(2),m("formGroup",e.registerForm),a(5),m("ngIf",(b=e.registerForm.get("email"))==null?null:b.hasError("required")),a(),m("ngIf",(v=e.registerForm.get("email"))==null?null:v.hasError("email")),a(6),m("ngIf",(C=e.registerForm.get("nombre"))==null?null:C.hasError("required")),a(9),m("ngForOf",e.roles),a(),m("ngIf",(M=e.registerForm.get("role"))==null?null:M.hasError("required")),a(4),m("type",e.hidePassword?"password":"text"),a(3),f(e.hidePassword?"visibility_off":"visibility"),a(),m("ngIf",(P=e.registerForm.get("password"))==null?null:P.hasError("required")),a(),m("ngIf",(w=e.registerForm.get("password"))==null?null:w.hasError("minlength")),a(4),m("type",e.hideConfirmPassword?"password":"text"),a(3),f(e.hideConfirmPassword?"visibility_off":"visibility"),a(),m("ngIf",(y=e.registerForm.get("confirmPassword"))==null?null:y.hasError("required")),a(),m("ngIf",(O=e.registerForm.get("confirmPassword"))==null?null:O.hasError("passwordMismatch")),a(),m("disabled",e.registerForm.invalid||e.isLoading),a(),m("ngIf",!e.isLoading),a(),m("ngIf",e.isLoading)}},dependencies:[I,S,F,Z,K,$,H,J,Q,W,ae,oe,ne,ee,te,re,z,N,R,Y,U,D,j,ie,G,B,V,me,le,T,ge,se,de],styles:['@charset "UTF-8";.login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(135deg,#667eea,#764ba2)}.login-card[_ngcontent-%COMP%]{width:100%;max-width:400px;border-radius:var(--radius-xl);box-shadow:var(--shadow-xl);overflow:hidden;background:var(--surface-base);border:1px solid var(--border-light)}.login-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--primary-600) 0%,var(--primary-700) 100%);color:#fff;padding:var(--spacing-xl);text-align:center}.login-logo[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:var(--spacing-md);filter:drop-shadow(0 2px 4px rgba(0,0,0,.1))}.login-title[_ngcontent-%COMP%]{margin:0;font-size:1.75rem;font-weight:700;margin-bottom:var(--spacing-sm)}.login-subtitle[_ngcontent-%COMP%]{margin:0;font-size:1rem;opacity:.9;font-weight:400}.login-content[_ngcontent-%COMP%]{padding:var(--spacing-xl)}.login-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-lg)}.form-field[_ngcontent-%COMP%]{width:100%}.login-actions[_ngcontent-%COMP%]{margin-top:var(--spacing-xl);display:flex;flex-direction:column;gap:var(--spacing-md)}.login-button[_ngcontent-%COMP%]{width:100%;padding:var(--spacing-md);border-radius:var(--radius-lg);font-weight:600;font-size:1rem;transition:all var(--transition-fast);box-shadow:var(--shadow-sm)}.login-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:var(--shadow-md)}.login-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.forgot-password[_ngcontent-%COMP%]{text-align:center;margin-top:var(--spacing-md)}.forgot-password[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--primary-600);text-decoration:none;font-size:.875rem;transition:color var(--transition-fast)}.forgot-password[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--primary-700);text-decoration:underline}mat-form-field[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%]{color:var(--gray-600);font-weight:500}mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5}mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}mat-error[_ngcontent-%COMP%]{font-size:.875rem;margin-top:var(--spacing-xs);color:var(--error-600)}mat-form-field.ng-invalid.ng-touched[_ngcontent-%COMP%]   mat-form-field-wrapper[_ngcontent-%COMP%]{border-color:var(--error-500)}.loading[_ngcontent-%COMP%]{opacity:.7;pointer-events:none}.loading-spinner[_ngcontent-%COMP%]{display:inline-block;width:16px;height:16px;border:2px solid transparent;border-top:2px solid currentColor;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-right:var(--spacing-sm)}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.login-container[_ngcontent-%COMP%]{padding:var(--spacing-md);display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(135deg,#667eea,#764ba2)}.login-card[_ngcontent-%COMP%]{max-width:500px;width:100%;margin:2rem;padding:2rem;border-radius:12px;box-shadow:0 8px 32px #0000001a;background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.login-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem;color:#333;font-size:1.8rem;font-weight:600}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:1.5rem}.half-width[_ngcontent-%COMP%]{width:48%;margin-bottom:1.5rem}.name-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:1rem}.submit-button[_ngcontent-%COMP%]{height:48px;font-size:1rem;font-weight:500;border-radius:8px;margin-top:1rem}.login-form[_ngcontent-%COMP%], .register-form[_ngcontent-%COMP%]{padding-top:1.5rem}.mat-form-field[_ngcontent-%COMP%]   .mat-form-field-wrapper[_ngcontent-%COMP%]{padding-bottom:0}.success-snackbar[_ngcontent-%COMP%]{background-color:#4caf50!important;color:#fff!important}.error-snackbar[_ngcontent-%COMP%]{background-color:#f44336!important;color:#fff!important}}@media (max-width: 480px){.login-container[_ngcontent-%COMP%]{padding:var(--spacing-sm)}.login-header[_ngcontent-%COMP%]{padding:var(--spacing-md)}.login-logo[_ngcontent-%COMP%]{font-size:2rem}.login-title[_ngcontent-%COMP%]{font-size:1.25rem}.login-content[_ngcontent-%COMP%]{padding:var(--spacing-md)}.login-form[_ngcontent-%COMP%]{gap:var(--spacing-md)}.login-card[_ngcontent-%COMP%]{margin:1rem;padding:1.5rem}.login-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:1.5rem}.name-row[_ngcontent-%COMP%]{flex-direction:column;gap:0}.half-width[_ngcontent-%COMP%]{width:100%}}.login-container[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-out}.login-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .5s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.login-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInLeft .3s ease-out}.login-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:nth-child(1){animation-delay:.1s}.login-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}@keyframes _ngcontent-%COMP%_slideInLeft{0%{opacity:0;transform:translate(-20px)}to{opacity:1;transform:translate(0)}}@media (prefers-color-scheme: dark){.login-container[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--gray-800) 0%,var(--gray-900) 100%)}.login-card[_ngcontent-%COMP%]{background-color:var(--gray-800);border-color:var(--gray-700)}.login-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--primary-700) 0%,var(--primary-800) 100%)}.login-content[_ngcontent-%COMP%]{color:var(--gray-100)}mat-form-field.ng-invalid.ng-touched[_ngcontent-%COMP%]   mat-form-field-wrapper[_ngcontent-%COMP%]{border-color:var(--error-400)}}.username-field[_ngcontent-%COMP%]   mat-form-field-wrapper[_ngcontent-%COMP%]{border-color:var(--primary-200)}.password-field[_ngcontent-%COMP%]   mat-form-field-wrapper[_ngcontent-%COMP%]{border-color:var(--secondary-200)}.login-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.login-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:var(--gray-100);border-radius:var(--radius-full)}.login-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--gray-300);border-radius:var(--radius-full)}.login-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--gray-400)}  .success-snackbar{background-color:var(--success-600)!important;color:#fff!important}  .error-snackbar{background-color:var(--error-600)!important;color:#fff!important}']})};export{ce as LoginComponent};
